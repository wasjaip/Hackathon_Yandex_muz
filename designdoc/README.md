# ML System Design Doc

## Введение

В рамках данного проекта необходимо разработать систему машинного обучения, способную классифицировать музыкальные треки как каверы или оригиналы, группировать каверы с исходными треками и определять исходный трек в цепочке каверов. Эта система значительно улучшит качество рекомендаций музыкального сервиса и удовлетворит потребности пользователей в управлении потоком треков.

## Цели проекта

1. Классификация треков как кавер/не кавер.
2. Группировка каверов с исходными треками.
3. Определение исходного трека в цепочке каверов.

## Исходные данные

### Данные для тестирования решений

- **covers.json**: Разметка каверов с уникальными идентификаторами треков, метками типа трека (оригинал/кавер) и идентификаторами исходных треков.
- **Метаинформация**: Содержит данные о дате появления информации о треке, названии, языке исполнения, жанрах и длительности.
- **Тексты песен**: Включает уникальные идентификаторы треков, тексты и идентификаторы текстов.

### Внешние источники данных

- [MusicBrainz](https://musicbrainz.org/)
- [AcousticBrainz](https://acousticbrainz.org/)
- [MusicMetaLinker](https://github.com/andreamust/MusicMetaLinker)

## Предположения

- Мелодии могут быть на разных языках.
- Треки могут быть перепеты тем же автором.
- Некоторые исходники могут отсутствовать в данных.

## Решение

### Методология

1. **Предобработка данных**: Очистка, нормализация и интеграция данных из различных источников.
2. **Извлечение признаков**: Анализ текстов песен, метаинформации и аудио-характеристик для создания векторного представления треков.
3. **Модель классификации**: Обучение модели для бинарной классификации треков как кавер/не кавер.
4. **Кластеризация**: Группировка каверов с исходными треками и определение исходного трека в цепочке каверов.
5. **Ранжирование**: Оценка схожести треков внутри кластеров для создания линейки эволюции композиции.

### Алгоритмы и технологии

- **NLP-модели** для анализа текстов песен.
- **Методы классификации** (например, SVM, Random Forest, Neural Networks) для определения кавер/не кавер.
- **Алгоритмы кластеризации** (например, K-means, DBSCAN) для группировки треков.
- **Метрики схожести** (например, косинусное сходств)

## Ожидаемый результат

- **ML-продукт**: Система, способная находить в датасете композиции, похожие на заданную мелодию, и формировать группы треков.
- **Ранжирование**: Система должна ранжировать все мелодии внутри группы по степени схожести и датам создания.
- **Полезность**: Разработка должна показать преимущества такого подхода для пользователей и бизнеса.

## Критерии оценки

1. **Код**: Корректность, эффективность, комментирование и соответствие PEP8.
2. **ML-модель**: Корректность выбора, обоснованность, оценка качества и независимость скриптов.
3. **Выводы**: Частные и общие выводы, гипотезы и их проверка.
4. **Соблюдение дедлайнов**.
5. **Комплексность и эффективность решения**: Адекватность метрики качества и соответствие требованиям бизнеса.

## Этапы реализации

1. **Сбор и предобработка данных**: Интеграция данных из различных источников и их подготовка.
2. **Исследование и анализ данных**: Понимание структуры данных и формулирование гипотез.
3. **Разработка и обучение модели**: Применение методов машинного обучения для достижения целей проекта.
4. **Тестирование и оптимизация**: Проверка качества модели и её улучшение. 
5. **Деплоймент**: Развертывание системы в производственной среде.
6. **Мониторинг и обслуживание**: Отслеживание работы системы и её обновление.

## Заключение

Разработанная система машинного обучения позволит улучшить пользовательский опыт, предоставляя более точные и персонализированные рекомендации, а также даст бизнесу новые возможности для удержания и привлечения аудитории.
